<!doctype html>
<html class="no-js" lang="">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title></title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="apple-touch-icon" href="apple-touch-icon.png">
    <!-- Place favicon.ico in the root directory -->

    <script src="js/jquery-1.11.3.min.js"></script>
    <script src="js/ScrollMagic.min.js"></script>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
<!--[if lt IE 8]>
<p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade
    your browser</a> to improve your experience.</p>
<![endif]-->

<!-- Add your site or application content here -->
<div class="fixed-top well">
    <button id="qsbk" data-type="qsbk" class="gallery btn btn-block">qsbk</button>
    <button id="dbmz" data-type="dbmz" class="gallery btn btn-block">dbmz</button>
    <button id="haha" data-type="haha" class="gallery btn btn-block">haha</button>
</div>
<div id="content"></div>
<div id="loader">
    <img src="image/loading.gif">
    <span onclick="reset()">LOADING...</span>
</div>


<script type="text/javascript">
    var page = 1;
    var type = 'haha';
    $('#' + type).addClass('btn-primary');
    // init controller
    var controller = new ScrollMagic.Controller();

    // build scene
    var scene = new ScrollMagic.Scene({triggerElement: "#loader", triggerHook: "onEnter"})
                    .addTo(controller)
                    .on("enter", function (e) {
                        if (!$("#loader").hasClass("active")) {
                            $("#loader").addClass("active");
                            // simulate ajax call to add content using the function below
                            setTimeout(loadImages, 1000, 9);
                        }
                    });

    function loadImages(amount) {
         $.getJSON('v0/' + type + '/images/' + page, function(data) {
                $.each( data.images, function(key, val) {
                    if ($('#'+ val.id).length == 0) {
                        var img = '<img class="img-polaroid" id="' + val.id + '" src="' + val.src + '" title="' + val.alt + '"/>';
                        if (val.href != null) {
                            img = '<a target="_blank" href="' + val.href + '">' + img + '</a>';
                        }
                        $("#content").append('<div class="image">' + img + '</div>');
                    }
              });
            });

            // "loading" done -> revert to normal state
            scene.update(); // make sure the scene gets the new start position
            $("#loader").removeClass("active");
            page = page + 1;
        }

    //loadImages(page);

    function reset() {
        page = 1;
    }

    $('.gallery').click(function() {
        var old = type;
        $('.gallery').removeClass('btn-primary');
        $(this).addClass('btn-primary');
        type = $(this).data('type');

        if (type != old) {
            page = 1;
            $('#content').empty();
        }
    });


</script>

</body>
</html>
