<!doctype html>
<html class="no-js" lang="">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title></title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="apple-touch-icon" href="apple-touch-icon.png">
    <!-- Place favicon.ico in the root directory -->

    <script src="jquery-1.11.3.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.5/ScrollMagic.min.js"></script>
    <style>
        div.image {
        float: left;
        margin-bottom: 10px;
        margin-left: 10px;
        }
        #loader {
        float: right;
        margin-bottom: 5px;
        }
    </style>
</head>
<body>
<!--[if lt IE 8]>
<p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade
    your browser</a> to improve your experience.</p>
<![endif]-->

<!-- Add your site or application content here -->
<div id="content"></div>
<div id="loader">
    <img src="loading.gif">
    LOADING...
</div>


<script type="text/javascript">
    var page = 1;
    // init controller
    var controller = new ScrollMagic.Controller();

    // build scene
    var scene = new ScrollMagic.Scene({triggerElement: "#loader", triggerHook: "onEnter"})
                    .addTo(controller)
                    .on("enter", function (e) {
                        if (!$("#loader").hasClass("active")) {
                            $("#loader").addClass("active");
                            // simulate ajax call to add content using the function below
                            setTimeout(loadImages, 1000, 9);
                        }
                    });

    function loadImages (amount) {
         $.getJSON("/v0/images/" + page, function(data) {
                $.each( data.images, function(key, val) {
                    $("#content").append('<div class="image"><img src="' + val.src + '" title="' + val.alt + '"/></div>');
              });
            });

            // "loading" done -> revert to normal state
            scene.update(); // make sure the scene gets the new start position
            $("#loader").removeClass("active");
            page = page + 1;
        }

    loadImages(page);
</script>

</body>
</html>
